<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>مجتهد - تخطيط المذاكرة المتقدم</title>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <style>
        :root {
            --primary: #6A5ACD;
            --primary-light: #8378DB;
            --secondary: #4B0082;
            --dark: #121212;
            --darker: #0A0A0A;
            --light: #1E1E1E;
            --text: #E0E0E0;
            --text-light: #F0F0F0;
            --accent: #20B2AA;
            --success: #32CD32;
            --warning: #FFD700;
            --danger: #DC143C;
            --completed: #32CD32;
            --almost-done: #FFA500;
            --not-started: #DC143C;
        }
        
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
        }
        
        body {
            background: linear-gradient(135deg, var(--darker) 0%, var(--dark) 100%);
            color: var(--text);
            min-height: 100vh;
            padding: 20px;
            line-height: 1.6;
        }
        
        .container {
            max-width: 1200px;
            margin: 0 auto;
        }
        
        header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 20px 0;
            margin-bottom: 30px;
            border-bottom: 1px solid rgba(255, 255, 255, 0.1);
        }
        
        .logo {
            display: flex;
            align-items: center;
            gap: 15px;
        }
        
        .logo h1 {
            font-size: 2.5rem;
            background: linear-gradient(to right, var(--primary), var(--accent));
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            font-weight: 800;
        }
        
        .nav-buttons {
            display: flex;
            gap: 15px;
        }
        
        .btn {
            padding: 12px 25px;
            border-radius: 30px;
            border: none;
            cursor: pointer;
            font-weight: 600;
            transition: all 0.3s ease;
        }
        
        .btn-primary {
            background: linear-gradient(135deg, var(--primary) 0%, var(--secondary) 100%);
            color: white;
        }
        
        .btn-primary:hover {
            transform: translateY(-2px);
            box-shadow: 0 5px 15px rgba(106, 90, 205, 0.4);
        }
        
        .btn-outline {
            background: transparent;
            border: 2px solid var(--primary);
            color: var(--primary);
        }
        
        .btn-outline:hover {
            background: rgba(106, 90, 205, 0.1);
        }
        
        .dashboard {
            display: grid;
            grid-template-columns: 1fr 2fr;
            gap: 25px;
            margin-bottom: 40px;
        }
        
        .sidebar {
            background: rgba(30, 30, 30, 0.6);
            border-radius: 15px;
            padding: 25px;
            backdrop-filter: blur(10px);
            border: 1px solid rgba(255, 255, 255, 0.1);
        }
        
        .sidebar h2 {
            margin-bottom: 20px;
            display: flex;
            align-items: center;
            gap: 10px;
        }
        
        .sidebar h2 i {
            color: var(--accent);
        }
        
        .main-content {
            display: flex;
            flex-direction: column;
            gap: 25px;
        }
        
        .stats-cards {
            display: grid;
            grid-template-columns: repeat(3, 1fr);
            gap: 20px;
            margin-bottom: 25px;
        }
        
        .stat-card {
            background: rgba(30, 30, 30, 0.6);
            border-radius: 15px;
            padding: 20px;
            text-align: center;
            backdrop-filter: blur(10px);
            border: 1px solid rgba(255, 255, 255, 0.1);
        }
        
        .stat-card i {
            font-size: 2.5rem;
            margin-bottom: 15px;
        }
        
        .stat-card.completed i {
            color: var(--completed);
        }
        
        .stat-card.almost-done i {
            color: var(--almost-done);
        }
        
        .stat-card.not-started i {
            color: var(--not-started);
        }
        
        .stat-number {
            font-size: 2.2rem;
            font-weight: bold;
            margin-bottom: 5px;
        }
        
        .stat-title {
            font-size: 1rem;
            opacity: 0.8;
        }
        
        .planning-section {
            background: rgba(30, 30, 30, 0.6);
            border-radius: 15px;
            padding: 25px;
            backdrop-filter: blur(10px);
            border: 1px solid rgba(255, 255, 255, 0.1);
        }
        
        .section-header {
            margin-bottom: 20px;
            display: flex;
            align-items: center;
            gap: 10px;
        }
        
        .section-header h2 {
            font-size: 1.8rem;
            background: linear-gradient(to right, var(--primary), var(--accent));
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
        }
        
        .tabs {
            display: flex;
            gap: 10px;
            margin-bottom: 20px;
            border-bottom: 1px solid rgba(255, 255, 255, 0.1);
            padding-bottom: 15px;
        }
        
        .tab {
            padding: 10px 20px;
            border-radius: 20px;
            cursor: pointer;
            transition: all 0.3s ease;
        }
        
        .tab.active {
            background: rgba(106, 90, 205, 0.2);
            color: var(--primary);
        }
        
        .tab-content {
            display: none;
        }
        
        .tab-content.active {
            display: block;
            animation: fadeIn 0.5s ease;
        }
        
        @keyframes fadeIn {
            from { opacity: 0; transform: translateY(10px); }
            to { opacity: 1; transform: translateY(0); }
        }
        
        .form-grid {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 20px;
        }
        
        .form-group {
            display: flex;
            flex-direction: column;
            gap: 8px;
        }
        
        .form-group label {
            font-weight: 500;
            display: flex;
            align-items: center;
            gap: 8px;
        }
        
        .form-group label i {
            color: var(--primary);
        }
        
        .form-group input, .form-group select, .form-group textarea {
            padding: 12px;
            border-radius: 8px;
            border: 1px solid rgba(255, 255, 255, 0.2);
            background: rgba(0, 0, 0, 0.2);
            color: var(--text);
            transition: all 0.3s ease;
        }
        
        .form-group input:focus, .form-group select:focus, .form-group textarea:focus {
            outline: none;
            border-color: var(--primary);
            box-shadow: 0 0 0 2px rgba(106, 90, 205, 0.3);
        }
        
        .form-group textarea {
            min-height: 100px;
            resize: vertical;
        }
        
        .form-actions {
            display: flex;
            justify-content: flex-end;
            gap: 15px;
            margin-top: 20px;
            grid-column: span 2;
        }
        
        .study-plan-form {
            background: rgba(0, 0, 0, 0.2);
            border-radius: 10px;
            padding: 20px;
            margin-bottom: 25px;
        }
        
        .plan-result {
            background: rgba(0, 0, 0, 0.2);
            border-radius: 10px;
            padding: 20px;
            margin-top: 20px;
            display: none;
        }
        
        .daily-plan {
            margin-top: 15px;
        }
        
        .day-plan {
            background: rgba(255, 255, 255, 0.05);
            border-radius: 8px;
            padding: 15px;
            margin-bottom: 10px;
            display: flex;
            justify-content: space-between;
            align-items: center;
        }
        
        .day-plan:hover {
            background: rgba(255, 255, 255, 0.08);
        }
        
        .update-progress {
            margin-top: 20px;
            text-align: center;
            display: none;
        }
        
        .progress-options {
            display: flex;
            justify-content: center;
            gap: 15px;
            margin-top: 15px;
        }
        
        .progress-btn {
            padding: 10px 20px;
            border-radius: 20px;
            border: none;
            cursor: pointer;
            font-weight: 600;
            transition: all 0.3s ease;
        }
        
        .btn-completed {
            background: var(--completed);
            color: white;
        }
        
        .btn-almost {
            background: var(--almost-done);
            color: white;
        }
        
        .btn-not {
            background: var(--not-started);
            color: white;
        }
        
        .goals-list {
            display: flex;
            flex-direction: column;
            gap: 15px;
            margin-top: 20px;
        }
        
        .goal-item {
            background: rgba(0, 0, 0, 0.2);
            border-radius: 10px;
            padding: 15px;
            border-left: 4px solid var(--primary);
            display: flex;
            justify-content: space-between;
            align-items: center;
        }
        
        .goal-info h3 {
            margin-bottom: 5px;
            color: var(--accent);
        }
        
        .goal-meta {
            display: flex;
            gap: 15px;
            margin-top: 10px;
            font-size: 0.9rem;
            opacity: 0.8;
        }
        
        .goal-meta span {
            display: flex;
            align-items: center;
            gap: 5px;
        }
        
        .goal-status {
            padding: 6px 12px;
            border-radius: 20px;
            font-size: 0.8rem;
            font-weight: 600;
        }
        
        .status-completed {
            background: rgba(50, 205, 50, 0.2);
            color: var(--completed);
        }
        
        .status-almost {
            background: rgba(255, 165, 0, 0.2);
            color: var(--almost-done);
        }
        
        .status-not {
            background: rgba(220, 20, 60, 0.2);
            color: var(--not-started);
        }
        
        .goal-actions {
            display: flex;
            gap: 10px;
        }
        
        .goal-btn {
            padding: 8px 12px;
            border-radius: 6px;
            border: none;
            cursor: pointer;
            transition: all 0.3s ease;
        }
        
        .btn-edit {
            background: rgba(32, 178, 170, 0.2);
            color: var(--accent);
        }
        
        .btn-delete {
            background: rgba(220, 20, 60, 0.2);
            color: var(--danger);
        }
        
        footer {
            text-align: center;
            padding: 30px 0;
            margin-top: 50px;
            border-top: 1px solid rgba(255, 255, 255, 0.1);
            font-size: 0.9rem;
            opacity: 0.7;
        }
        
        .current-day {
            border: 2px solid var(--primary);
            box-shadow: 0 0 10px rgba(106, 90, 205, 0.5);
        }
        
        .progress-message {
            margin-top: 15px;
            padding: 10px;
            border-radius: 8px;
            text-align: center;
            display: none;
        }
        
        .progress-success {
            background: rgba(50, 205, 50, 0.2);
            color: var(--completed);
            border: 1px solid var(--completed);
        }
        
        .progress-warning {
            background: rgba(255, 165, 0, 0.2);
            color: var(--almost-done);
            border: 1px solid var(--almost-done);
        }
        
        .progress-danger {
            background: rgba(220, 20, 60, 0.2);
            color: var(--not-started);
            border: 1px solid var(--not-started);
        }
        
        .day-progress {
            display: flex;
            gap: 8px;
            margin-top: 10px;
        }
        
        .day-progress-btn {
            padding: 6px 12px;
            border-radius: 15px;
            border: none;
            cursor: pointer;
            font-size: 0.8rem;
            font-weight: 500;
            transition: all 0.3s ease;
        }
        
        .day-progress-btn i {
            margin-right: 4px;
        }
        
        .day-progress-completed {
            background: rgba(50, 205, 50, 0.2);
            color: var(--completed);
            border: 1px solid var(--completed);
        }
        
        .day-progress-completed:hover {
            background: var(--completed);
            color: white;
        }
        
        .day-progress-almost {
            background: rgba(255, 165, 0, 0.2);
            color: var(--almost-done);
            border: 1px solid var(--almost-done);
        }
        
        .day-progress-almost:hover {
            background: var(--almost-done);
            color: white;
        }
        
        .day-progress-not {
            background: rgba(220, 20, 60, 0.2);
            color: var(--not-started);
            border: 1px solid var(--not-started);
        }
        
        .day-progress-not:hover {
            background: var(--not-started);
            color: white;
        }
        
        .day-content {
            display: flex;
            flex-direction: column;
            flex-grow: 1;
        }
        
        .day-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 8px;
        }
        
        @media (max-width: 900px) {
            .dashboard {
                grid-template-columns: 1fr;
            }
            
            .stats-cards {
                grid-template-columns: 1fr;
            }
            
            .form-grid {
                grid-template-columns: 1fr;
            }
            
            .form-actions {
                grid-column: span 1;
            }
            
            .progress-options {
                flex-direction: column;
                align-items: center;
            }
            
            .day-plan {
                flex-direction: column;
                align-items: flex-start;
            }
            
            .day-progress {
                align-self: flex-end;
                margin-top: 10px;
            }
        }
        
        @media (max-width: 600px) {
            header {
                flex-direction: column;
                gap: 20px;
            }
            
            .nav-buttons {
                width: 100%;
                justify-content: center;
            }
            
            .goal-item {
                flex-direction: column;
                align-items: flex-start;
                gap: 15px;
            }
            
            .goal-actions {
                align-self: flex-end;
            }
            
            .day-progress {
                flex-wrap: wrap;
                justify-content: flex-end;
            }
        }
    </style>
</head>
<body>
    <div class="container">
        <header>
            <div class="logo">
                <i class="fas fa-graduation-cap"></i>
                <h1>مجتهد - تخطيط المذاكرة</h1>
            </div>
            
            <div class="nav-buttons">
                <button class="btn btn-primary" onclick="location.href='home.html'">العودة للتطبيق</button>
                <button class="btn btn-outline" onclick="resetPage()">بدء جديد</button>
            </div>
        </header>
        
        <div class="stats-cards">
            <div class="stat-card completed">
                <i class="fas fa-check-circle"></i>
                <div class="stat-number">3</div>
                <div class="stat-title">أيام مكتملة</div>
            </div>
            
            <div class="stat-card almost-done">
                <i class="fas fa-hourglass-half"></i>
                <div class="stat-number">2</div>
                <div class="stat-title">أيام جزئية</div>
            </div>
            
            <div class="stat-card not-started">
                <i class="fas fa-times-circle"></i>
                <div class="stat-number">5</div>
                <div class="stat-title">أيام لم تبدأ بعد</div>
            </div>
        </div>
        
        <div class="dashboard">
            <div class="sidebar">
                <h2><i class="fas fa-bullseye"></i> الأهداف الحالية</h2>
                
                <div class="goals-list">
                    <div class="goal-item">
                        <div class="goal-info">
                            <h3>إنهاء فصل التفاضل والتكامل</h3>
                            <p>إكمال جميع تمارين الفصل الخامس من كتاب الرياضيات</p>
                            <div class="goal-meta">
                                <span><i class="fas fa-book"></i> الرياضيات</span>
                                <span><i class="fas fa-calendar"></i> 2023-12-15</span>
                            </div>
                        </div>
                        <div class="goal-status status-completed">مكتمل</div>
                    </div>
                    
                    <div class="goal-item">
                        <div class="goal-info">
                            <h3>مراجعة التجارب الكيميائية</h3>
                            <p>مراجعة وتلخيص 10 تجارب كيميائية للامتحان العملي</p>
                            <div class="goal-meta">
                                <span><i class="fas fa-book"></i> الكيمياء</span>
                                <span><i class="fas fa-calendar"></i> 2023-12-10</span>
                            </div>
                        </div>
                        <div class="goal-status status-almost">أوشكت على الانتهاء</div>
                    </div>
                    
                    <div class="goal-item">
                        <div class="goal-info">
                            <h3>حل نماذج امتحانات السنوات السابقة</h3>
                            <p>حل 5 نماذج امتحانات سابقة لمادة الفيزياء</p>
                            <div class="goal-meta">
                                <span><i class="fas fa-book"></i> الفيزياء</span>
                                <span><i class="fas fa-calendar"></i> 2023-12-20</span>
                            </div>
                        </div>
                        <div class="goal-status status-not">لم تبدأ بعد</div>
                    </div>
                </div>
            </div>
            
            <div class="main-content">
                <div class="planning-section">
                    <div class="section-header">
                        <i class="fas fa-calendar-alt"></i>
                        <h2>تخطيط مذاكرة الاختبار</h2>
                    </div>
                    
                    <div class="tabs">
                        <div class="tab active" data-tab="study-plan">خطة المذاكرة</div>
                        <div class="tab" data-tab="goals">تتبع الأهداف</div>
                    </div>
                    
                    <div class="tab-content active" id="study-plan">
                        <div class="study-plan-form">
                            <div class="form-grid">
                                <div class="form-group">
                                    <label for="subject"><i class="fas fa-book"></i> المادة</label>
                                    <input type="text" id="subject" placeholder="أدخل اسم المادة">
                                </div>
                                <div class="form-group">
                                    <label for="total-pages"><i class="fas fa-file-alt"></i> عدد الصفحات</label>
                                    <input type="number" id="total-pages" placeholder="عدد الصفحات الكلي">
                                </div>
                                <div class="form-group">
                                    <label for="days-left"><i class="fas fa-calendar-day"></i> الأيام المتبقية</label>
                                    <input type="number" id="days-left" placeholder="الأيام حتى الامتحان" min="0" step="0.1">
                                </div>
                                <div class="form-group" id="hours-per-day-group">
                                    <label for="hours-per-day"><i class="fas fa-clock"></i> ساعات المذاكرة اليومية</label>
                                    <input type="number" id="hours-per-day" placeholder="عدد الساعات المتاحة يومياً" value="2">
                                </div>
                            </div>
                            <div class="form-actions">
                                <button class="btn btn-primary" onclick="calculatePlan()">إنشاء الخطة</button>
                            </div>
                        </div>
                        
                        <div class="plan-result" id="planResult">
                            <h3>خطة المذاكرة المقترحة</h3>
                            <p id="planSummary">سيظهر هنا ملخص الخطة</p>
                            
                            <div class="daily-plan" id="dailyPlan">
                                <!-- سيتم إضافة الخطة اليومية هنا -->
                            </div>
                            
                            <div class="update-progress" id="updateProgress">
                                <h4>إحصائيات التقدم</h4>
                                <div class="progress-message" id="progressMessage"></div>
                            </div>
                        </div>
                    </div>
                    
                    <div class="tab-content" id="goals">
                        <div class="form-grid">
                            <div class="form-group">
                                <label for="goal-title"><i class="fas fa-pencil-alt"></i> عنوان الهدف</label>
                                <input type="text" id="goal-title" placeholder="أدخل عنوان الهدف">
                            </div>
                            <div class="form-group">
                                <label for="goal-subject"><i class="fas fa-book"></i> المادة</label>
                                <select id="goal-subject">
                                    <option value="">اختر المادة</option>
                                    <option value="math">الرياضيات</option>
                                    <option value="physics">الفيزياء</option>
                                    <option value="chemistry">الكيمياء</option>
                                    <option value="biology">الأحياء</option>
                                </select>
                            </div>
                            <div class="form-group">
                                <label for="goal-desc"><i class="fas fa-align-left"></i> وصف الهدف</label>
                                <textarea id="goal-desc" placeholder="أدخل وصفاً مفصلاً للهدف"></textarea>
                            </div>
                            <div class="form-group">
                                <label for="goal-deadline"><i class="fas fa-calendar"></i> الموعد النهائي</label>
                                <input type="date" id="goal-deadline">
                            </div>
                            <div class="form-group">
                                <label for="goal-status"><i class="fas fa-tasks"></i> الحالة</label>
                                <select id="goal-status">
                                    <option value="not-started">لم تبدأ بعد</option>
                                    <option value="almost-done">أوشكت على الانتهاء</option>
                                    <option value="completed">مكتمل</option>
                                </select>
                            </div>
                            <div class="form-actions">
                                <button class="btn btn-outline" onclick="resetGoalForm()">إعادة تعيين</button>
                                <button class="btn btn-primary" onclick="saveGoal()">حفظ الهدف</button>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
        
        <footer>
            <p>© 2023 مجتهد. جميع الحقوق محفوظة.</p>
            <p>نظام تخطيط المذاكرة المتقدم - صمم لتحقيق أقصى استفادة من وقت الدراسة</p>
        </footer>
    </div>

    <script>
        // بيانات التطبيق
        let studyPlan = {
            days: [],
            currentDayIndex: 0
        };
        let currentGoals = [];
        
        // تهيئة الصفحة
        document.addEventListener('DOMContentLoaded', function() {
            // نظام التبويبات
            const tabs = document.querySelectorAll('.tab');
            const tabContents = document.querySelectorAll('.tab-content');
            
            tabs.forEach(tab => {
                tab.addEventListener('click', function() {
                    const tabId = this.getAttribute('data-tab');
                    
                    // إلغاء تفعيل جميع التبويبات والمحتويات
                    tabs.forEach(t => t.classList.remove('active'));
                    tabContents.forEach(c => c.classList.remove('active'));
                    
                    // تفعيل التبويب والمحتوى المحدد
                    this.classList.add('active');
                    document.getElementById(tabId).classList.add('active');
                });
            });
            
            // تحميل الأهداف المحفوظة
            loadGoals();
            
            // التحقق من إخفاء حقل ساعات المذاكرة
            document.getElementById('days-left').addEventListener('input', toggleHoursField);
        });
        
        // إخفاء/إظهار حقل ساعات المذاكرة حسب الأيام المتبقية
        function toggleHoursField() {
            const daysLeft = parseFloat(document.getElementById('days-left').value);
            const hoursPerDayGroup = document.getElementById('hours-per-day-group');
            
            if (daysLeft < 1) {
                hoursPerDayGroup.style.display = 'none';
            } else {
                hoursPerDayGroup.style.display = 'flex';
            }
        }
        
        // حساب خطة المذاكرة
        function calculatePlan() {
            const subject = document.getElementById('subject').value;
            const totalPages = parseInt(document.getElementById('total-pages').value);
            const daysLeftInput = parseFloat(document.getElementById('days-left').value);
            const hoursPerDay = parseInt(document.getElementById('hours-per-day').value) || 2;
            
            if (!subject || !totalPages || isNaN(daysLeftInput)) {
                alert('يرجى ملء جميع الحقول المطلوبة');
                return;
            }
            
            // حساب الصفحات اليومية
            let pagesPerUnit;
            let planType = 'يوم';
            let unitsLeft;
            
            if (daysLeftInput >= 1) {
                // إذا كان الوقت أكثر من يوم، نستخدم الأيام
                unitsLeft = Math.ceil(daysLeftInput);
                pagesPerUnit = Math.ceil(totalPages / unitsLeft);
            } else {
                // إذا كان الوقت أقل من يوم، نستخدم الساعات
                unitsLeft = 24; // 24 ساعة في اليوم
                pagesPerUnit = Math.ceil(totalPages / unitsLeft);
                planType = 'ساعة';
            }
            
            // عرض النتائج
            const planResult = document.getElementById('planResult');
            const planSummary = document.getElementById('planSummary');
            const dailyPlan = document.getElementById('dailyPlan');
            
            if (daysLeftInput >= 1) {
                planSummary.textContent = `لمادة ${subject}: ${totalPages} صفحة خلال ${unitsLeft} يوم بمعدل ${pagesPerUnit} صفحة لكل ${planType}`;
            } else {
                planSummary.textContent = `لمادة ${subject}: ${totalPages} صفحة خلال 24 ساعة بمعدل ${pagesPerUnit} صفحة لكل ${planType}`;
            }
            
            // إنشاء الخطة اليومية
            dailyPlan.innerHTML = '';
            studyPlan.days = [];
            
            if (daysLeftInput >= 1) {
                for (let i = 1; i <= unitsLeft; i++) {
                    studyPlan.days.push({
                        day: i,
                        pages: pagesPerUnit,
                        status: 'not-started',
                        type: 'day'
                    });
                    
                    const dayPlan = document.createElement('div');
                    dayPlan.className = 'day-plan';
                    dayPlan.id = `day-${i}`;
                    dayPlan.innerHTML = `
                        <div class="day-content">
                            <div class="day-header">
                                <div>
                                    <strong>اليوم ${i}:</strong> 
                                    <span>${pagesPerUnit} صفحة</span>
                                </div>
                                <div class="goal-status status-not">لم تبدأ بعد</div>
                            </div>
                            <div class="day-progress">
                                <button class="day-progress-btn day-progress-completed" onclick="updateDayProgress(${i}, 'completed')">
                                    <i class="fas fa-check"></i> أنجزت الكل
                                </button>
                                <button class="day-progress-btn day-progress-almost" onclick="updateDayProgress(${i}, 'almost')">
                                    <i class="fas fa-minus"></i> جزء فقط
                                </button>
                                <button class="day-progress-btn day-progress-not" onclick="updateDayProgress(${i}, 'not')">
                                    <i class="fas fa-times"></i> لم أنجز شيئاً
                                </button>
                            </div>
                        </div>
                    `;
                    dailyPlan.appendChild(dayPlan);
                }
            } else {
                for (let i = 1; i <= unitsLeft; i++) {
                    studyPlan.days.push({
                        day: i,
                        pages: pagesPerUnit,
                        status: 'not-started',
                        type: 'hour'
                    });
                    
                    const hourPlan = document.createElement('div');
                    hourPlan.className = 'day-plan';
                    hourPlan.id = `hour-${i}`;
                    hourPlan.innerHTML = `
                        <div class="day-content">
                            <div class="day-header">
                                <div>
                                    <strong>الساعة ${i}:</strong> 
                                    <span>${pagesPerUnit} صفحة</span>
                                </div>
                                <div class="goal-status status-not">لم تبدأ بعد</div>
                            </div>
                            <div class="day-progress">
                                <button class="day-progress-btn day-progress-completed" onclick="updateDayProgress(${i}, 'completed')">
                                    <i class="fas fa-check"></i> أنجزت الكل
                                </button>
                                <button class="day-progress-btn day-progress-almost" onclick="updateDayProgress(${i}, 'almost')">
                                    <i class="fas fa-minus"></i> جزء فقط
                                </button>
                                <button class="day-progress-btn day-progress-not" onclick="updateDayProgress(${i}, 'not')">
                                    <i class="fas fa-times"></i> لم أنجز شيئاً
                                </button>
                            </div>
                        </div>
                    `;
                    dailyPlan.appendChild(hourPlan);
                }
            }
            
            // إظهار قسم تحديث التقدم
            document.getElementById('updateProgress').style.display = 'block';
            
            // إظهار نتيجة الخطة
            planResult.style.display = 'block';
            
            // حفظ تفاصيل الخطة
            studyPlan.subject = subject;
            studyPlan.totalPages = totalPages;
            studyPlan.daysLeft = daysLeftInput;
            studyPlan.hoursPerDay = hoursPerDay;
            studyPlan.pagesPerUnit = pagesPerUnit;
            studyPlan.planType = planType;
            studyPlan.unitsLeft = unitsLeft;
            studyPlan.currentDayIndex = 0;
            
            // تحديث الإحصائيات
            updateStatistics();
        }
        
        // تحديث تقدم يوم معين
        function updateDayProgress(dayIndex, status) {
            const day = studyPlan.days.find(d => d.day === dayIndex);
            if (!day) return;
            
            const dayElement = document.getElementById(`${day.type}-${dayIndex}`);
            const statusElement = dayElement.querySelector('.goal-status');
            
            // إزالة جميع classes السابقة
            statusElement.classList.remove('status-not', 'status-almost', 'status-completed');
            
            // تحديث الحالة بناء على الاختيار
            if (status === 'completed') {
                day.status = 'completed';
                statusElement.classList.add('status-completed');
                statusElement.textContent = 'مكتمل';
            } else if (status === 'almost') {
                day.status = 'almost-done';
                statusElement.classList.add('status-almost');
                statusElement.textContent = 'جزئي';
            } else {
                day.status = 'not-started';
                statusElement.classList.add('status-not');
                statusElement.textContent = 'لم تبدأ بعد';
            }
            
            // حفظ الخطة في التخزين المحلي
            savePlanToStorage();
            
            // تحديث الإحصائيات
            updateStatistics();
        }
        
        // تحديث الإحصائيات
        function updateStatistics() {
            const completed = studyPlan.days.filter(day => day.status === 'completed').length;
            const almost = studyPlan.days.filter(day => day.status === 'almost-done').length;
            const notStarted = studyPlan.days.filter(day => day.status === 'not-started').length;
            
            // تحديث بطاقات الإحصائيات
            document.querySelector('.stat-card.completed .stat-number').textContent = completed;
            document.querySelector('.stat-card.almost-done .stat-number').textContent = almost;
            document.querySelector('.stat-card.not-started .stat-number').textContent = notStarted;
            
            // عرض رسالة التقدم
            const progressMessage = document.getElementById('progressMessage');
            const totalDays = studyPlan.days.length;
            
            if (completed === totalDays) {
                progressMessage.textContent = "تهانينا! لقد أنهيت جميع أيام المذاكرة بنجاح. أنت مستعد للاختبار!";
                progressMessage.className = "progress-message progress-success";
            } else if (completed > 0 || almost > 0) {
                const progressPercent = Math.round(((completed + almost * 0.5) / totalDays) * 100);
                progressMessage.textContent = `تقدمك في الخطة: ${progressPercent}% (${completed} يوم مكتمل، ${almost} يوم جزئي، ${notStarted} يوم متبقي)`;
                progressMessage.className = "progress-message progress-warning";
            } else {
                progressMessage.textContent = `لم تبدأ بعد في خطة المذاكرة. لديك ${notStarted} يوم للمذاكرة.`;
                progressMessage.className = "progress-message progress-danger";
            }
            
            progressMessage.style.display = 'block';
        }
        
        // حفظ الهدف
        function saveGoal() {
            const title = document.getElementById('goal-title').value;
            const subject = document.getElementById('goal-subject').value;
            const description = document.getElementById('goal-desc').value;
            const deadline = document.getElementById('goal-deadline').value;
            const status = document.getElementById('goal-status').value;
            
            if (!title || !subject || !deadline) {
                alert('يرجى ملء جميع الحقول المطلوبة');
                return;
            }
            
            // إنشاء كائن الهدف
            const goal = {
                id: Date.now(),
                title: title,
                subject: subject,
                description: description,
                deadline: deadline,
                status: status,
                createdAt: new Date().toISOString()
            };
            
            // إضافة الهدف إلى القائمة
            currentGoals.push(goal);
            
            // حفظ الأهداف في localStorage
            saveGoalsToStorage();
            
            // إعادة تحميل قائمة الأهداف
            loadGoals();
            
            // إعادة تعيين الحقول
            resetGoalForm();
            
            alert('تم حفظ الهدف بنجاح!');
        }
        
        // إعادة تعيين نموذج الهدف
        function resetGoalForm() {
            document.getElementById('goal-title').value = '';
            document.getElementById('goal-subject').value = '';
            document.getElementById('goal-desc').value = '';
            document.getElementById('goal-deadline').value = '';
            document.getElementById('goal-status').value = 'not-started';
        }
        
        // تحميل الأهداف
        function loadGoals() {
            // في التطبيق الحقيقي، سيتم جلب البيانات من localStorage أو API
            // هنا سنستخدم بيانات وهمية للعرض
            
            const goals = [
                {
                    id: 1,
                    title: 'إنهاء فصل التفاضل والتكامل',
                    subject: 'الرياضيات',
                    description: 'إكمال جميع تمارين الفصل الخامس من كتاب الرياضيات',
                    deadline: '2023-12-15',
                    status: 'completed'
                },
                {
                    id: 2,
                    title: 'مراجعة التجارب الكيميائية',
                    subject: 'الكيمياء',
                    description: 'مراجعة وتلخيص 10 تجارب كيميائية للامتحان العملي',
                    deadline: '2023-12-10',
                    status: 'almost-done'
                },
                {
                    id: 3,
                    title: 'حل نماذج امتحانات السنوات السابقة',
                    subject: 'الفيزياء',
                    description: 'حل 5 نماذج امتحانات سابقة لمادة الفيزياء',
                    deadline: '2023-12-20',
                    status: 'not-started'
                }
            ];
            
            currentGoals = goals;
            renderGoals();
        }
        
        // عرض الأهداف
        function renderGoals() {
            const goalsList = document.querySelector('.goals-list');
            goalsList.innerHTML = '';
            
            currentGoals.forEach(goal => {
                const goalItem = document.createElement('div');
                goalItem.className = 'goal-item';
                
                let statusClass = 'status-not';
                let statusText = 'لم تبدأ بعد';
                
                if (goal.status === 'completed') {
                    statusClass = 'status-completed';
                    statusText = 'مكتمل';
                } else if (goal.status === 'almost-done') {
                    statusClass = 'status-almost';
                    statusText = 'أوشكت على الانتهاء';
                }
                
                goalItem.innerHTML = `
                    <div class="goal-info">
                        <h3>${goal.title}</h3>
                        <p>${goal.description}</p>
                        <div class="goal-meta">
                            <span><i class="fas fa-book"></i> ${goal.subject}</span>
                            <span><i class="fas fa-calendar"></i> ${goal.deadline}</span>
                        </div>
                    </div>
                    <div class="goal-status ${statusClass}">${statusText}</div>
                `;
                
                goalsList.appendChild(goalItem);
            });
        }
        
        // حفظ الأهداف في التخزين المحلي
        function saveGoalsToStorage() {
            localStorage.setItem('studyGoals', JSON.stringify(currentGoals));
        }
        
        // حفظ الخطة في التخزين المحلي
        function savePlanToStorage() {
            localStorage.setItem('studyPlan', JSON.stringify(studyPlan));
        }
        
        // إعادة تعيين الصفحة
        function resetPage() {
            document.getElementById('subject').value = '';
            document.getElementById('total-pages').value = '';
            document.getElementById('days-left').value = '';
            document.getElementById('hours-per-day').value = '2';
            document.getElementById('planResult').style.display = 'none';
            document.getElementById('hours-per-day-group').style.display = 'flex';
            
            resetGoalForm();
            
            studyPlan = {
                days: [],
                currentDayIndex: 0
            };
            
            // إعادة تعيين رسالة التقدم
            document.getElementById('progressMessage').style.display = 'none';
            
            alert('تم إعادة تعيين الصفحة بنجاح');
        }
    </script>
</body>
</html>